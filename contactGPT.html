<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exemplo de utilização da API do Google People em JavaScript</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>

<body>
    <button id="authorize_button" style="display: none;">Autorizar</button>
    <button id="signout_button" style="display: none;">Sair</button>
    <pre id="output"></pre>

    <script>
        // Variáveis globais
        var CLIENT_ID = 'sua-chave-de-api-aqui';
        var DISCOVERY_DOCS = ["https://people.googleapis.com/$discovery/rest?version=v1"];
        var SCOPES = "https://www.googleapis.com/auth/contacts.readonly";

        // Funções de inicialização
        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: CLIENT_ID,
                discoveryDocs: DISCOVERY_DOCS,
                scope: SCOPES
            }).then(function () {
                // Escuta os eventos de mudança de status da autenticação
                gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

                // Verifica o status de autenticação atual
                updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
                authorizeButton.onclick = handleAuthClick;
                signoutButton.onclick = handleSignoutClick;
            }, function (error) {
                console.log(JSON.stringify(error, null, 2));
            });
        }

        // Funções de autenticação
        function updateSigninStatus(isSignedIn) {
            if (isSignedIn) {
                authorizeButton.style.display = 'none';
                signoutButton.style.display = 'block';
                listContacts();
            } else {
                authorizeButton.style.display = 'block';
                signoutButton.style.display = 'none';
            }
        }

        function handleAuthClick(event) {
            gapi.auth2.getAuthInstance().signIn();
        }

        function handleSignoutClick(event) {
            gapi.auth2.getAuthInstance().signOut();
        }

        // Funções de solicitação de contatos
        function listContacts() {
            gapi.client.people.people.connections.list({
                'resourceName': 'people/me',
                'pageSize': 10,
                'personFields': 'names,emailAddresses'
            }).then(function (response) {
                var connections = response.result.connections;
                appendPre('Contatos:');

                if (connections.length > 0) {
                    for (i = 0; i < connections.length; i++) {
                        var person = connections[i];
                        if (person.names && person.names.length > 0) {


    </script>

</body>

</html>